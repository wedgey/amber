<section class="text-center">
  <p id="notice"><%= notice %></p>

  <h1><%= @farm.name %></h1>


<section class="container">
  <div class="row">
    <div class="col-sm-5">
      <canvas id="farm-layout-show" width="400" height="400" style="border:1px solid #000000;">
      </canvas>
    </div>

    <div class="col-sm-2"></div>

    <div class="col-sm-5 farm-show-info">

  <p>
    <strong>Farm code:</strong>
    <%= @farm.farm_code %>
  </p>

  <p>
    <strong>Lat:</strong>
    <%= @farm.lat %>
  </p>

  <p>
    <strong>Lng:</strong>
    <%= @farm.lng %>
  </p>


  <p>
    <strong>Size:</strong>
    <%= @farm.size %>
  </p>

<hr>

<!-- start tabs -->
      <ul class="nav nav-pills sub_farm_tabs">
        <li class='to-new-subfarm'><%= link_to 'Add Sub Farm', new_farm_sub_farm_path(@farm), class: 'btn btn-success', method: 'GET' %></li>
      </ul>

      <div class="tab-content sub_farm_content">
      </div>
<!-- end tabs -->

    </div>
  </div>
</section>






  <%= link_to 'Edit', edit_farm_path(@farm) %> |
  <%= link_to 'Back', farms_path %>
</section>

<script>
  $(function(){

    var farm = document.getElementById('farm-layout-show');
    var ctx = farm.getContext("2d");
    ctx.fillStyle = "#FF0000";

    <% @sub_farms.each do |subfarm| %>
      var a = $('<a data-toggle="pill" href="#subfarm<%= subfarm.id %>">').text('Subfarm <%= subfarm.id %>');
      var subfarm = $('<li>').append(a);
      subfarm.insertBefore('.to-new-subfarm');
      // $('.sub_farm_tabs').append(subfarm);


      var crop = $('<p>').html('<strong>Crop</strong> : <%= Crop.find(subfarm.crop_id).name %>');
      var size = $('<p>').html('<strong>Size</strong> : <%= subfarm.size %>');
      var crop_w = $('<p>').html('<strong>Crop weight</strong> : <%= subfarm.crop_weight %>');
      var start = $('<p>').html('<strong>Start date</strong> : <%= subfarm.start_date %>');
      var harvest = $('<p>').html('<strong>Harvest date</strong> : <%= subfarm.harvest_date %>');

      var content = $('<div id="subfarm<%= subfarm.id %>" class="tab-pane fade in active">').append(crop).append(size).append(crop_w).append(start).append(harvest);
      $('.sub_farm_content').append(content);

      <% if subfarm.x and subfarm.y and subfarm.width and subfarm.height %>
        
        ctx.fillRect(<%= subfarm.x.to_f %>, <%= subfarm.y.to_f %>, <%= subfarm.x.to_f + subfarm.width.to_f %>, <%= subfarm.y.to_f + subfarm.height.to_f %>);
      <% end %>
    <% end %>
    $('.sub_farm_tabs li:first-child').addClass('active');
    $('.sub_farm_content').children('div:not(:first-child)').removeClass('in active');

    // $('.sub_farm_content div').toggle();
    // ctx.fillRect(0,0,150,75);
  });
</script>

